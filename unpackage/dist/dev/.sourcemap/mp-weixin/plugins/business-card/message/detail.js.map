{"version":3,"sources":["uni-app:///main.js","webpack:////Users/apple/wwwweb/gongsi_sc/公司文件/前端代码/前端/plugins/business-card/message/detail.vue?f589","webpack:////Users/apple/wwwweb/gongsi_sc/公司文件/前端代码/前端/plugins/business-card/message/detail.vue?faea","webpack:////Users/apple/wwwweb/gongsi_sc/公司文件/前端代码/前端/plugins/business-card/message/detail.vue?8a22","webpack:////Users/apple/wwwweb/gongsi_sc/公司文件/前端代码/前端/plugins/business-card/message/detail.vue?c6ee","uni-app:///plugins/business-card/message/detail.vue","webpack:////Users/apple/wwwweb/gongsi_sc/公司文件/前端代码/前端/plugins/business-card/message/detail.vue?00f2","webpack:////Users/apple/wwwweb/gongsi_sc/公司文件/前端代码/前端/plugins/business-card/message/detail.vue?05c6"],"names":["createPage","Page"],"mappings":"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","file":"plugins/business-card/message/detail.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './plugins/business-card/message/detail.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./detail.vue?vue&type=template&id=63e98a48&scoped=true&\"\nvar renderjs\nimport script from \"./detail.vue?vue&type=script&lang=js&\"\nexport * from \"./detail.vue?vue&type=script&lang=js&\"\nimport style0 from \"./detail.vue?vue&type=style&index=0&id=63e98a48&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"63e98a48\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"plugins/business-card/message/detail.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=template&id=63e98a48&scoped=true&\"","var components\ntry {\n  components = {\n    comNavBar: function() {\n      return import(\n        /* webpackChunkName: \"components/com/com-nav-bar/com-nav-bar\" */ \"@/components/com/com-nav-bar/com-nav-bar.vue\"\n      )\n    }\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=script&lang=js&\"","<template>\n\t<view class=\"chat-root\">\n\t\t<com-nav-bar @clickLeft=\"back\" left-icon=\"back\" :fixed=\"true\" title=\"聊天\" :status-bar=\"true\" background-color=\"#ffffff\" :border=\"false\" color=\"#000000\"></com-nav-bar>\n\t\t\n\t\t<!-- <view style=\"height: 30rpx;width: 100%;\"></view> -->\n\t\t<scroll-view scroll-y=\"true\" class=\"scroll-box\" :scroll-with-animation=\"true\" :scroll-top=\"scrollTop\" :scroll-into-view=\"scrollToView\">\n\t\t\t<block v-if=\"msg_list.length > 0\">\n\t\t\t\t<view class=\"row\" v-for=\"(item,index) in msg_list\" :key='index' :id=\"'msg'+item.msg.id\">\n\t\t\t\t\t<!-- 我的消息 -->\n\t\t\t\t\t<block class=\"my\" v-if=\"item.type == user_id\">\n\t\t\t\t\t\t<view class=\"my-msg flex\" v-if=\"item.msg.type == 'text'\">\n\t\t\t\t\t\t\t<view class=\"my-content\">\n\t\t\t\t\t\t\t\t<rich-text :nodes=\"item.msg.content.text\"></rich-text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t<image class=\"my-avatar\" :src=\"item.msg.userinfo.avatar_url\" mode=\"\"></image>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"my-msg flex\" v-if=\"item.msg.type == 'img'\">\n\t\t\t\t\t\t\t<image class=\"my-msg-img\" :src=\"img_url+'ceshi/ceshi.png'\" mode=\"\"></image>\n\t\t\t\t\t\t\t<image class=\"my-avatar\" :src=\"img_url+'ceshi/ceshi.png'\" mode=\"\"></image>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</block>\n\t\t\t\t\t\n\t\t\t\t\t<!-- 别人的消息 -->\n\t\t\t\t\t<block class=\"other\" v-if=\"item.type == other_info.id\">\n\t\t\t\t\t\t<view class=\"my-msg flex other-msg\" v-if=\"item.msg.type == 'text'\">\n\t\t\t\t\t\t\t<image class=\"my-avatar\" :src=\"item.msg.userinfo.avatar_url\" mode=\"\"></image>\n\t\t\t\t\t\t\t<view class=\"my-content\">\n\t\t\t\t\t\t\t\t<rich-text :nodes=\"item.msg.content.text\"></rich-text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"my-msg flex other-msg\"v-if=\"item.msg.type == 'img'\">\n\t\t\t\t\t\t\t<image class=\"my-avatar\" :src=\"img_url+'ceshi/ceshi2.jpg'\" mode=\"\"></image>\n\t\t\t\t\t\t\t<image class=\"my-msg-img\" :src=\"img_url+'ceshi/ceshi.png'\" mode=\"\"></image>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</block>\n\t\t\t\t</view>\n\t\t\t</block>\n\t\t</scroll-view>\n\t\t\n\n\t\t<!-- 底部输入框 -->\n\t\t<view class=\"input-box flex flex-y-center flex-x-between\">\n\t\t\t<view class=\"iconfont icon-tianjia inp-icon\"></view>\n\t\t\t<view class=\"inp flex flex-y-center\">\n\t\t\t\t<!-- <input type=\"text\" value=\"\" style=\"padding: 0 10rpx;font-size: 28rpx;\"/> -->\n\t\t\t\t<textarea auto-height=\"true\" v-model=\"textMsg\" class=\"inp-content\" />\n\t\t\t\t</view>\n\t\t\t<view class=\"send-btn\" @tap=\"send\" :style=\"{background:textColor}\">\n\t\t\t\t发送\n\t\t\t</view>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\n\timport JMessage from '@/common/jmessage-wxapplet-sdk-1.4.3.min.js';\n\tconst JIM = new JMessage();\n\t\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\timg_url: this.$api.img_url,\n\t\t\t\ttextMsg:'',\n\t\t\t\tscrollTop:0,\n\t\t\t\tscrollToView:'',\n\t\t\t\tother_info:'',//聊天对方的信息\n\t\t\t\tunread_msg:[],\n\t\t\t\tmsg_list:[],\n\t\t\t\tuser_id: '',\n\t\t\t\tuserInfo:'',\n\t\t\t};\n\t\t},\n\t\tonShow() {\n\t\t\tthis.scrollTop = 9999999;\n\t\t},\n\t\tonLoad() {\n\t\t\tif(uni.getStorageSync('userInfo')){\n\t\t\t\tthis.userInfo = JSON.parse(uni.getStorageSync('userInfo'));\n\t\t\t\tthis.user_id = this.userInfo.user_id;\n\t\t\t}\n\t\t\tif(uni.getStorageSync('mall_config')){\n\t\t\t\tthis.textColor = this.globalSet('textCol');\n\t\t\t}\n\t\t\t\n\t\t\tif(uni.getStorageSync('other_info')){\n\t\t\t\tthis.other_info = JSON.parse(uni.getStorageSync('other_info'));\n\t\t\t\tif(this.other_info.avatar_url == ''){\n\t\t\t\t\tthis.other_info.avatar_url = this.img_url+'images/business/business-default.jpg';\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tthis.$http.toast('找不到用户');\n\t\t\t\tsetTimeout(()=>{\n\t\t\t\t\tthis.navBack();\n\t\t\t\t},1000)\n\t\t\t}\n\t\t\tthis.getMsgList();\n\t\t\tthis.getConversation(); //离线监听\n\t\t\tconsole.log(JIM.isLogin(),'JIM.isLogin()');\n\t\t\tif(!JIM.isLogin()){\n\t\t\t\tthis.getInitData();\n\t\t\t}\n\t\t},\n\t\tonUnload(){\n\t\t\tJIM.loginOut();\n\t\t},\n\t\tmethods:{\n\t\t\tback(){ //返回事件，并将聊天数据发送给后端\n\t\t\t\tthis.navBack();\n\t\t\t\tvar arr;\n\t\t\t\tif(this.msg_list.length > 10){\n\t\t\t\t\tarr = this.msg_list.slice(-10);\n\t\t\t\t}\n\t\t\t\tthis.$http.request({\n\t\t\t\t\turl:this.$api.plugin.business.message_add,\n\t\t\t\t\tmethod:'post',\n\t\t\t\t\tdata:{\n\t\t\t\t\t\tuser_id: this.userInfo.user_id,\n\t\t\t\t\t\ttarget_user_id: this.other_info.id.split(\"_\")[1],\n\t\t\t\t\t\tform_data: arr ? arr : this.msg_list\n\t\t\t\t\t}\n\t\t\t\t}).then(res => {\n\t\t\t\t\tif(res.code != 0){\n\t\t\t\t\t\tthis.$http.toast(res.msg);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tuni.removeStorage({ //清除存在缓存的未读信息\n\t\t\t\t    key: this.other_info.id,\n\t\t\t\t    success: function (res) {\n\t\t\t\t        console.log('success');\n\t\t\t\t    }\n\t\t\t\t});\n\t\t\t},\n\t\t\tgetMsgList(){ //获取历史记录\n\t\t\t\tvar that = this;\n\t\t\t\tthis.$http.request({\n\t\t\t\t\turl:this.$api.plugin.business.message_list,\n\t\t\t\t\tmethod:'post',\n\t\t\t\t\tshowLoading:true,\n\t\t\t\t\tdata:{\n\t\t\t\t\t\tuser_id: this.userInfo.user_id,\n\t\t\t\t\t\ttarget_user_id: this.other_info.id.split(\"_\")[1],\n\t\t\t\t\t}\n\t\t\t\t}).then(res => {\n\t\t\t\t\tif(res.code == 0){\n\t\t\t\t\t\tif(res.data.list.length > 0){\n\t\t\t\t\t\t\tthis.msg_list.push(...res.data.list);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(uni.getStorageSync(this.other_info.id)){ //获取缓存的数据，看是否有新数据\n\t\t\t\t\t\t\tvar history_arr = JSON.parse(uni.getStorageSync(this.other_info.id));\n\t\t\t\t\t\t\thistory_arr.forEach((item,index)=>{\n\t\t\t\t\t\t\t\titem.msg.userinfo.avatar_url = that.other_info.avatar_url;\n\t\t\t\t\t\t\t\titem.msg.userinfo.username = that.other_info.nickname;\n\t\t\t\t\t\t\t\titem.msg.id = this.msg_list.length + 2;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tthis.msg_list.push(...history_arr);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\tgetInitData(){ //初始化极光\n\t\t\t\tthis.$http.request({\n\t\t\t\t\turl:this.$api.plugin.business.message_init,\n\t\t\t\t\tmethod:'post',\n\t\t\t\t\tshowLoading:true,\n\t\t\t\t}).then(res => {\n\t\t\t\t\tif(res.code == 0){\n\t\t\t\t\tconsole.log(res,'ressss');\n\t\t\t\t\t\tJIM.init({ //极光初始化\n\t\t\t\t\t\t\t\"appkey\" : res.data.app_key,\n\t\t\t\t\t\t\t\"random_str\" : res.data.random_str,\n\t\t\t\t\t\t\t\"signature\" : res.data.signature,\n\t\t\t\t\t\t\t\"timestamp\" : res.data.timestamp,\n\t\t\t\t\t\t\t\"flag\" : 0\n\t\t\t\t\t\t}).onSuccess((data)=>{\n\t\t\t\t\t\t\tconsole.log('初始化成功');\n\t\t\t\t\t\t\tthis.jmRegister(this.user_id,this.userInfo.nickname,'my');\n\t\t\t\t\t\t\tthis.jmRegister(this.other_info.id,this.other_info.nickname,'other');\n\t\t\t\t\t\t}).onFail((data)=>{\n\t\t\t\t\t\t\tthis.$http.toast('初始化失败');\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\tjmRegister(userId,name,str){ //注册极光聊天\n\t\t\t\tconsole.log(userId,name,str,'userId,name,str');\n\t\t\t\tJIM.register({\n\t\t\t\t\t'username' : str == 'my'?'user_' + userId : userId,\n\t\t\t\t\t'password' : 'jx888888',\n\t\t\t\t\t'nickname' : name,\n\t\t\t\t\t'is_md5' : false,\n\t\t\t\t\t'extras' : {'key1':'val1','key2':'val2'},\n\t\t\t\t\t'address' : '深圳'\n\t\t\t\t}).onSuccess((data)=>{\n\t\t\t\t\tconsole.log('注册成功');\n\t\t\t\t\tif(str == 'my'){\n\t\t\t\t\t\tthis.jmLogin(this.userInfo);\n\t\t\t\t\t}\n\t\t\t\t}).onFail((data)=>{\n\t\t\t\t\tif(data.code == 882002){\n\t\t\t\t\t\tconsole.log('用户已存在，直接跳登录');\n\t\t\t\t\t\tif(str == 'my'){\n\t\t\t\t\t\t\tthis.jmLogin(this.userInfo);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.$http.toast(data.message);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tjmLogin(){ //登录极光聊天\n\t\t\tconsole.log(this.user_id,'this.user_idjmLoginjmLoginjmLogin');\n\t\t\t\tJIM.login({\n\t\t\t\t    'username' : 'user_'+this.user_id,\n\t\t\t\t    'password' : 'jx888888',\n\t\t\t\t}).onSuccess((data)=>{\n\t\t\t\t\tconsole.log('登录成功');\n\t\t\t\t\tthis.getMsg();\n\t\t\t\t}).onFail(function(data){\n\t\t\t\t\tconsole.log(data,'onFail');\n\t\t\t\t\tthis.$http.toast('聊天登录失败');\n\t\t\t\t});\n\t\t\t},\n\t\t\tsend(){\n\t\t\t\tif(!this.textMsg){return;}\n\t\t\t\t\n\t\t\t\tJIM.sendSingleMsg({ //发送信息\n\t\t\t\t    'target_username' : this.other_info.id,\n\t\t\t\t    'content' : this.textMsg,\n\t\t\t\t\t'need_receipt':false\n\t\t\t\t}).onSuccess((data)=>{\n\t\t\t\t    console.log(data,'发送成功');\n\t\t\t\t\tthis.addMsg(this.user_id,data.ctime_ms,this.userInfo.nickname,this.userInfo.avatar,this.textMsg);\n\t\t\t\t\tthis.textMsg = '';\n\t\t\t\t}).onFail((data)=>{\n\t\t\t\t\tthis.$http.toast('发送失败');\n\t\t\t\t\tconsole.log(data,'onFail');\n\t\t\t\t}).onTimeout((data)=>{\n\t\t\t\t    if (data.response_timeout) {\n\t\t\t\t        // do something when response timeout\n\t\t\t\t    } else {\n\t\t\t\t        // do something when request timeout\n\t\t\t\t    }\n\t\t\t\t}).onAck((data)=>{});\n\t\t\t},\n\t\t\tgetMsg(){ //接收数据\n\t\t\t\tJIM.onMsgReceive((data)=>{\n\t\t\t\t\tconsole.log(data,'接收数据');\n\t\t\t\t\tthis.judgeId(data.messages,'online');\n\t\t\t\t});\n\t\t\t},\n\t\t\taddMsg(type,time,username,avatar_url,text){\n\t\t\t\tvar length = this.msg_list.length;\n\t\t\t\tif(avatar_url == ''){\n\t\t\t\t\tavatar_url = this.img_url+'images/business/business-default.jpg';\n\t\t\t\t}\n\t\t\t\tlet msg = {type,msg:{id:length+1,type:'text',time,userinfo:{username,avatar_url,id:this.userInfo.user_id},otherInfo:this.other_info,content:{text}}};\n\t\t\t\tthis.msg_list.push(msg);\n\t\t\t\tconsole.log(this.msg_list,'msg_list');\n\t\t\t\t\n\t\t\t\tthis.$nextTick(()=>{ //滚动到底\n\t\t\t\t\tthis.scrollToView = 'msg'+msg.msg.id\n\t\t\t\t});\n\t\t\t},\n\t\t\tgetConversation(){ //接受离线消息\n\t\t\t\tJIM.onSyncConversation((data) => {\n\t\t\t\t\tconsole.log(data,'离线消息');\n\t\t\t\t\tthis.judgeId(data[0].msgs,'offline');\n\t\t\t\t});\n\t\t\t},\n\t\t\tjudgeId(val,str){\n\t\t\t\tval.forEach((item,index) => {\n\t\t\t\t\tif(this.other_info.id == item.content.from_id){\n\t\t\t\t\t\tthis.addMsg(item.content.from_id,item.ctime_ms,this.other_info.nickname,this.other_info.avatar_url,item.content.msg_body.text);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(this.user_id != item.content.from_id){\n\t\t\t\t\t\t\tlet msg = {type:item.content.from_id,msg:{id:0,time:item.ctime_ms,type:item.content.msg_type,userinfo:{username:'',avatar_url:''},content:{text:item.content.msg_body.text}}};\n\t\t\t\t\t\t\tif(uni.getStorageSync(item.content.from_id)){\n\t\t\t\t\t\t\t\tvar arr2 = JSON.parse(uni.getStorageSync(item.content.from_id));\n\t\t\t\t\t\t\t\tarr2.push(msg);\n\t\t\t\t\t\t\t\tuni.setStorageSync(item.content.from_id,JSON.stringify(arr2));\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tvar arrs = [];\n\t\t\t\t\t\t\t\tarrs.push(msg);\n\t\t\t\t\t\t\t\tuni.setStorageSync(item.content.from_id,JSON.stringify(arrs));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style lang=\"scss\" scoped>\n\t.scroll-box{\n\t\tpadding: 0rpx 20rpx 0;\n\t\tposition: absolute;\n\t\twidth: 100%;\n\t\t/* bottom: 50px; */\n\t\t/* top: calc(var(--status-bar-height) + 88rpx + 20px); */\n\t\theight:100%;\n\t\tpadding-bottom: 100rpx;\n\t\tbox-sizing: border-box;\n\t\t// height: calc(100% - 50px - 44px - var(--status-bar-height) - 20px);\n\t}\n\t.my-msg{\n\t\tcolor: #000000;\n\t\tjustify-content: flex-end;\n\t\tmargin-bottom: 20rpx;\n\t\talign-items: flex-start;\n\t\t\n\t\t.my-avatar{\n\t\t\twidth: 70rpx;\n\t\t\theight: 70rpx;\n\t\t\tborder-radius: 6rpx;\n\t\t\tflex-shrink: 0;\n\t\t}\n\t\t.my-content{\n\t\t\tbackground: #f37e8b;\n\t\t\tmargin-right: 10rpx;\n\t\t\tpadding: 14rpx;\n\t\t\tborder-radius: 6rpx;\n\t\t\tfont-size: 28rpx;\n\t\t}\n\t\t.my-msg-img{\n\t\t\twidth: 200rpx;\n\t\t\theight: 300rpx;\n\t\t\tmargin-right: 10rpx;\n\t\t\tborder-radius: 6rpx;\n\t\t}\n\t}\n\t\n\t.other-msg{\n\t\tjustify-content: flex-start;\n\t\t\n\t\t.my-avatar{\n\t\t\tmargin-right: 10rpx;\n\t\t}\n\t\t.my-content{\n\t\t\tbackground: #FFFFFF;\n\t\t}\n\t}\n\t\n\t// 底部输入框\n\t.input-box{\n\t\tposition: fixed;\n\t\tbottom: 0;\n\t\tbackground: #F7F7F7;\n\t\twidth: 100%;\n\t\tborder-top: 1px solid #e3e3e3;\n\t\tpadding: 12rpx 20rpx;\n\t\tbox-sizing: border-box;\n\t\theight: 100rpx;\n\t\t\n\t\t.inp-icon{\n\t\t\tfont-size: 50rpx;\n\t\t}\n\t\t.inp{\n\t\t\tbackground: #FFFFFF;\n\t\t\tborder-radius: 6rpx;\n\t\t\twidth: 500rpx;\n\t\t\tpadding: 10rpx 0;\n\t\t}\n\t\t.send-btn{\n\t\t\theight: 60rpx;\n\t\t\tpadding: 0 20rpx;\n\t\t\tline-height: 60rpx;\n\t\t\tbackground: #BC0100;\n\t\t\tborder-radius: 6rpx;\n\t\t\tfont-size: 28rpx;\n\t\t\tcolor: #FFFFFF;\n\t\t}\n\t\t.inp-content{\n\t\t\tpadding: 0 10rpx;\n\t\t\tfont-size: 28rpx;\n\t\t}\n\t}\n\t\n</style>\n","import mod from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=style&index=0&id=63e98a48&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=style&index=0&id=63e98a48&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1610955371359\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}